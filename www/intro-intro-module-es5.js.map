{"version":3,"sources":["webpack:///src/app/intro/intro.page.html","webpack:///src/app/intro/intro-routing.module.ts","webpack:///src/app/intro/intro.module.ts","webpack:///src/app/intro/intro.page.scss","webpack:///src/app/intro/intro.page.ts"],"names":["routes","path","component","IntroPageRoutingModule","imports","forChild","exports","IntroPageModule","declarations","IntroPage","_UserService","fcm","_ActivatedRoute","_platform","_Router","_AppService","isLogged","plugin_state","notification_count","getToken","then","token","localStorage","setItem","error","ready","is","subscribeToTopic","_device_id","get_device_id","onTokenRefresh","subscribe","newToken","user_post_data","get_platform","getItem","res","onNotification","payload","wasTapped","clearAllNotifications","unsubscribeFromTopic","url","router_navigation","setupFCM","is_user_logged_routing","selector","template"],"mappings":"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","file":"intro-intro-module-es5.js","sourcesContent":["export default \"<app-page-loader *ngIf=\\\"isLogged == false\\\"></app-page-loader>\\r\\n<div class=\\\"wrapper\\\" id=\\\"app\\\">\\r\\n  <div class=\\\"intro-box\\\"><img class=\\\"intro-box__bg\\\" src=\\\"assets/img/intro.png\\\"/>\\r\\n    <div class=\\\"intro-box__inside\\\">\\r\\n      <div class=\\\"intro-box__data\\\"><img src=\\\"assets/img/logo-white.png\\\"/>\\r\\n        <p>أخبار الرياضة وكرة القدم السعودية والعالمية من مصادر حصرية تنشر أول بأول</p>\\r\\n      </div>\\r\\n      <div class=\\\"intro-box__action\\\">\\r\\n        <a routerLink=\\\"/register\\\" class=\\\"btn btn--block btn--primary\\\">إنشاء حساب جديد</a>\\r\\n        <a routerLink=\\\"/login\\\" class=\\\"btn btn--block btn--secondary\\\">تسجيل دخول</a>\\r\\n        <a routerLink=\\\"/home\\\" class=\\\"btn\\\">إستمرار بدون دخول</a></div>\\r\\n    </div>\\r\\n  </div>\\r\\n</div>\";","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { IntroPage } from './intro.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: IntroPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class IntroPageRoutingModule {}\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { IntroPageRoutingModule } from './intro-routing.module';\r\n\r\nimport { IntroPage } from './intro.page';\r\nimport { SharedComponentsModule } from '../shared/shared.components';\r\n\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    IntroPageRoutingModule,\r\n    SharedComponentsModule\r\n  ],\r\n  declarations: [IntroPage]\r\n})\r\nexport class IntroPageModule {}\r\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL2ludHJvL2ludHJvLnBhZ2Uuc2NzcyJ9 */\";","import { Component, OnInit } from '@angular/core';\nimport { UserService } from '../user.service';\n\nimport { FCM } from 'cordova-plugin-fcm-with-dependecy-updated/ionic/ngx'\nimport { ActivatedRoute, Router, NavigationExtras } from '@angular/router';\nimport { Platform } from '@ionic/angular';\nimport { AppService } from '../services/app.service';\n\n\n\n\n@Component({\n    selector: 'app-intro',\n    templateUrl: './intro.page.html',\n    styleUrls: ['./intro.page.scss'],\n})\nexport class IntroPage implements OnInit {\n\n    isLogged = false\n\n    plugin_state = false\n    notification_count = 0\n\n    public hasPermission: boolean;\n    public token: string;\n    _device_id\n    _subscribe: any\n\n    constructor(private _UserService: UserService, private fcm: FCM,\n        private _ActivatedRoute: ActivatedRoute, private _platform: Platform, private _Router: Router, private _AppService: AppService) {\n\n    }\n\n\n\n    getToken() {\n        this.fcm.getToken().then(function (token) {\n            if (token) {\n                localStorage.setItem(\"fcm_token\", token);\n            }\n        })\n            .catch(function (error) {\n            });\n    }\n\n    async setupFCM() {\n        //  alert('2')\n        // if (!this.plugin_state) {\n\n        await this._platform.ready();\n        if (!this._platform.is('cordova')) {\n            return;\n        }\n\n        await this.fcm.subscribeToTopic('arriyadiyah');\n\n        this._device_id = this._UserService.get_device_id()\n        localStorage.setItem('device_id', this._device_id)\n        // alert('3'+this._device_id)\n        this.getToken()\n        this.fcm.onTokenRefresh().subscribe((newToken) => {\n            if (newToken) {\n                localStorage.setItem(\"fcm_token\", newToken);\n                this._AppService.user_post_data(`user/update`, {\n                    \"device_id\": this._UserService.get_device_id(),\n                    \"device_type\": this._AppService.get_platform(),\n                    \"token\": newToken\n                }, 's', localStorage.getItem('token'))\n                    .subscribe((res => {\n\n                    }))\n                // this.updateToken(newToken, this._device_id);\n\n            }\n        });\n\n\n\n\n\n        this.fcm.onNotification().subscribe((payload) => {\n            if (payload.wasTapped) {\n                // let navigationExtras: NavigationExtras = { state: { data: payload } };\n                // this._Router.navigate(['single-notification'], navigationExtras);\n            }\n            else {\n                // if (localStorage.getItem('notification_count')) {\n                //   localStorage.setItem('notification_count', localStorage.getItem('notification_count') + '1')\n                // } else {\n                //   localStorage.setItem('notification_count', '1')\n                // }\n            }\n\n\n\n            this.fcm.clearAllNotifications()\n\n            this.fcm.unsubscribeFromTopic('arriyadiyah');\n            // this.plugin_state = true\n        })\n\n\n\n        // }\n\n    }\n\n\n\n\n\n    is_user_logged_routing() {\n        if (localStorage.getItem('token') != null) {\n            if (this._Router.url == '/login' || this._Router.url == '/register' || this._Router.url == '/intro') {\n                // this.isLogged = true\n                this._AppService.router_navigation('/home')\n            }\n        } else {\n            this.isLogged = true\n            // this._AppService.router_navigation('/intro')\n        }\n    }\n\n\n\n\n    ngOnInit() {\n        // alert('ss')\n\n        // alert('1')\n        this.setupFCM()\n        this.is_user_logged_routing()\n        // this._UserService.is_user_logged_routing()\n        // this._ActivatedRoute.params.subscribe(val => {\n\n        //   this._platform.ready().then(() => {\n        //     .then(function () {\n        //       // console.log('ss')\n        //     })\n        //       .catch(function (error) {\n        //       });\n\n\n        //   });\n        // })\n    }\n\n}\n"]}